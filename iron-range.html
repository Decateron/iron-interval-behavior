<!--
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<!--
The `iron-range` element is used for managing a numeric value within a given 
range.  It has no visual appearance and is typically used in conjunction with 
another element.

One can build a progress bar using `iron-range` like this:

  <iron-range min="0" max="200" value="100" ratio="{{ratio}}"></iron-range>
  <div class="progress-bar" style="width: {{ratio}}%;"></div>

@group Polymer Iron Elements
@element iron-range
@homepage github.io

-->

<link rel="import" href="../polymer/polymer.html">

<script>

Polymer({

  is: 'iron-range',

  properties: {

    /**
     * The number that represents the current value.
     *
     * @attribute value
     * @type number
     * @default 0
     */
    value: {
      type: Number,
      value: 0
    },
    
    /**
     * The number that indicates the minimum value of the range.
     *
     * @attribute min
     * @type number
     * @default 0
     */
    min: {
      type: Number,
      value: 0
    },
    
    /**
     * The number that indicates the maximum value of the range.
     *
     * @attribute max
     * @type number
     * @default 100
     */
    max: {
      type: Number,
      value: 100
    },
    
    /**
     * Specifies the value granularity of the range's value.
     *
     * @attribute step
     * @type number
     * @default 1
     */
    step: {
      type: Number,
      value: 1
    },
    
    /**
     * Returns the ratio of the value.
     *
     * @attribute ratio
     * @type number
     * @default 0
     */
    ratio: {
      type: Number,
      value: 0,
      readOnly: true,
      notify: true
    },
  },
  
  observers: [
    '_update(value, min, max, step)'
  ],
  
  _calcRatio: function(value) {
    return (this._clampValue(value) - this.min) / (this.max - this.min);
  },
  
  _clampValue: function(value) {
    return Math.min(this.max, Math.max(this.min, this._calcStep(value)));
  },
  
  _calcStep: function(value) {
    return this.step ? (Math.round(value / this.step) / (1 / this.step)) : value;
  },
  
  _validateValue: function() {
    var v = this._clampValue(this.value);
    this.value = this.oldValue = isNaN(v) ? this.oldValue : v;
    return this.value !== v;
  },
  
  _update: function() {
    this._validateValue();
    this._setRatio(this._calcRatio(this.value) * 100);
  }
  
});
</script>
